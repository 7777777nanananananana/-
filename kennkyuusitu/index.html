<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>ユニクロ服おすすめAI</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700&family=Noto+Sans+JP:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <h1><span class="logo"></span>ユニクロ服おすすめAI</h1>
        <form id="promptForm">
            <label for="userPrompt">どんな服が欲しいですか？<br><span class="example">（例: 夏にぴったりのカジュアルな服）</span></label>
            <input type="text" id="userPrompt" name="userPrompt" size="40" required placeholder="ご希望の服やシーンを入力してください">
            <button type="submit"><span class="sparkle">✨</span>おすすめを聞く</button>
        </form>
        <div id="response"></div>
        <footer>
            <small>Powered by OpenAI | <a href="https://www.uniqlo.com/jp/" target="_blank">ユニクロ公式サイト</a></small>
        </footer>
    </div>
    <script>
        document.getElementById('promptForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            const userPrompt = document.getElementById('userPrompt').value;
            const responseDiv = document.getElementById('response');
            responseDiv.textContent = "おすすめを考えています...";

            const systemPrompt = "あなたはユニクロの服の専門家です。ユーザーの要望に合ったユニクロの服を具体的な商品名や特徴とともに日本語でおすすめしてください。";

            try {
                const res = await fetch(`http://localhost:3000/api/chat`, {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify({
                        messages: [
                            { role: "system", content: systemPrompt },
                            { role: "user", content: userPrompt }
                        ]
                    })
                });
                const data = await res.json();
                if (data.choices && data.choices[0] && data.choices[0].message) {
                    responseDiv.innerHTML = `<div class='ai-response'>${data.choices[0].message.content.trim().replace(/\n/g, '<br>')}</div>`;
                } else {
                    responseDiv.textContent = "おすすめを取得できませんでした。";
                }
            } catch (err) {
                responseDiv.textContent = "エラーが発生しました。";
            }
        });
    </script>
    <script src="server.js"></script>
</body>
</html>